#include <stdio.h>
#include <string.h>

// NB: this program illustrates that when you add a command line argument
// that is bigger than 8 bytes, the value will overflow in buffer 1, and 
// if the argument is bigger than 20 bytes (buffer 1 + buffer 2 + value) the program will crash.
// Actually now the error is '15718 illegal hardware instruction' when you input >= 8 bytes

int main(int argc, char const *argv[])
{
    int value = 5;
    char buffer_one[8], buffer_two[8];

    strcpy(buffer_one, "one");
    strcpy(buffer_two, "two");
    
    printf("[BEFORE] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
    printf("[BEFORE] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
    printf("[BEFORE] value is at %p and is %d (0x%08x)\n", &value, value, value);

    printf("[STRCPY] copying %d bytes into buffer_two\n\n", strlen(argv[1]));
    strcpy(buffer_two, argv[1]); // Copy first command line argument to buffer 2
    
    printf("[AFTER] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
    printf("[AFTER] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
    printf("[AFTER] value is at %p and is %d (0x%08x)\n", &value, value, value);
}
